#include <stdlib.h>

int better_main()
{
    char* p1 = NULL;
    char* p2 = NULL;
    char* p3 = NULL;
    char* p4 = NULL;
    int return_code = 1;


    char* p1 = malloc(30);
    if(p1 == NULL)
    {
        goto END;
    }

    char* p2 = malloc(30);
    if(p2 == NULL)
    {
        goto END;
    }

    char* p3 = malloc(30);
    if(p3 == NULL)
    {
        goto END;
    }

    char* p4 = malloc(30);
    if(p4 == NULL)
    {
        goto END;
    }

    return_code = 0;
END:
    free(p1);
    free(p2);
    free(p3);
    free(p4);

    return return_code;
}

int main()
{
    char* p1 = malloc(30);
    if(p1 == NULL)
    {
        return 1;
    }

    char* p2 = malloc(56);
    if(p2 == NULL)
    {
        free(p1);
        return 1;
    }

    char* p3 = malloc(56);
    if(p3 == NULL)
    {
        free(p1);
        free(p2);
        return 1;
    }

    char* p4 = malloc(56);
    if(p4 == NULL)
    {
        free(p1);
        free(p2);
        free(p3);
        return 1;
    }

    free(p4);
    free(p3);
    free(p2);
    free(p1);
    return 0;
}